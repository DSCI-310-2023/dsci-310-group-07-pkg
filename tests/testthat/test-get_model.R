# tests for get_tr_tst()
test_that("get_tr_tst() failed", {
  df <- structure(list(symboling = structure(c(3L, 3L, 2L, 2L, 3L, 4L,
                                               4L, 4L, 3L, 2L, 4L, 2L, 2L, 2L, 2L, 2L, 2L, 5L, 1L, 3L), levels = c("3",
                                                                                                                   "1", "2", "0", "-1", "-2"), class = "factor"), `normalized-losses` = c(164,
                                                                                                                                                                                          164, 158, 158, 192, 192, 188, 188, 121, 98, 81, 118, 118, 118,
                                                                                                                                                                                          148, 148, 148, 110, 145, 137), make = structure(c(2L, 2L, 2L,
                                                                                                                                                                                                                                            2L, 3L, 3L, 3L, 3L, 4L, 4L, 4L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L,
                                                                                                                                                                                                                                            6L), levels = c("alfa-romero", "audi", "bmw", "chevrolet", "dodge",
                                                                                                                                                                                                                                                            "honda", "isuzu", "jaguar", "mazda", "mercedes-benz", "mercury",
                                                                                                                                                                                                                                                            "mitsubishi", "nissan", "peugot", "plymouth", "porsche", "renault",
                                                                                                                                                                                                                                                            "saab", "subaru", "toyota", "volkswagen", "volvo"), class = "factor"),
                       `fuel-type` = structure(c(1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L,
                                                 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L), levels = c("gas",
                                                                                                             "diesel"), class = "factor"), aspiration = structure(c(1L,
                                                                                                                                                                    1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 1L,
                                                                                                                                                                    1L, 1L, 2L, 1L), levels = c("std", "turbo"), class = "factor"),
                       `num-of-doors` = structure(c(2L, 2L, 2L, 2L, 1L, 2L, 1L,
                                                    2L, 1L, 1L, 2L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 1L, 1L), levels = c("two",
                                                                                                                    "four"), class = "factor"), `body-style` = structure(c(3L,
                                                                                                                                                                           3L, 3L, 3L, 3L, 3L, 3L, 3L, 2L, 2L, 3L, 2L, 2L, 2L, 2L, 3L,
                                                                                                                                                                           3L, 4L, 2L, 2L), levels = c("convertible", "hatchback", "sedan",
                                                                                                                                                                                                       "wagon", "hardtop"), class = "factor"), `drive-wheels` = structure(c(2L,
                                                                                                                                                                                                                                                                            3L, 2L, 2L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L,
                                                                                                                                                                                                                                                                            2L, 2L, 2L, 2L), levels = c("rwd", "fwd", "4wd"), class = "factor"),
                       `engine-location` = structure(c(1L, 1L, 1L, 1L, 1L, 1L, 1L,
                                                       1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L), levels = c("front",
                                                                                                                       "rear"), class = "factor"), `wheel-base` = c(99.8, 99.4,
                                                                                                                                                                    105.8, 105.8, 101.2, 101.2, 101.2, 101.2, 88.4, 94.5, 94.5,
                                                                                                                                                                    93.7, 93.7, 93.7, 93.7, 93.7, 93.7, 103.3, 95.9, 86.6), length = c(176.6,
                                                                                                                                                                                                                                       176.6, 192.7, 192.7, 176.8, 176.8, 176.8, 176.8, 141.1, 155.9,
                                                                                                                                                                                                                                       158.8, 157.3, 157.3, 157.3, 157.3, 157.3, 157.3, 174.6, 173.2,
                                                                                                                                                                                                                                       144.6), width = c(66.2, 66.4, 71.4, 71.4, 64.8, 64.8, 64.8,
                                                                                                                                                                                                                                                         64.8, 60.3, 63.6, 63.6, 63.8, 63.8, 63.8, 63.8, 63.8, 63.8,
                                                                                                                                                                                                                                                         64.6, 66.3, 63.9), height = c(54.3, 54.3, 55.7, 55.9, 54.3,
                                                                                                                                                                                                                                                                                       54.3, 54.3, 54.3, 53.2, 52, 52, 50.8, 50.8, 50.8, 50.6, 50.6,
                                                                                                                                                                                                                                                                                       50.6, 59.8, 50.2, 50.8), `curb-weight` = c(2337, 2824, 2844,
                                                                                                                                                                                                                                                                                                                                  3086, 2395, 2395, 2710, 2765, 1488, 1874, 1909, 1876, 1876,
                                                                                                                                                                                                                                                                                                                                  2128, 1967, 1989, 1989, 2535, 2811, 1713), `engine-type` = structure(c(3L,
                                                                                                                                                                                                                                                                                                                                                                                                         3L, 3L, 3L, 3L, 3L, 3L, 3L, 4L, 3L, 3L, 3L, 3L, 3L, 3L, 3L,
                                                                                                                                                                                                                                                                                                                                                                                                         3L, 3L, 3L, 3L), levels = c("dohc", "ohcv", "ohc", "l", "rotor",
                                                                                                                                                                                                                                                                                                                                                                                                                                     "ohcf", "dohcv"), class = "factor"), `num-of-cylinders` = structure(c(1L,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           3L, 3L, 3L, 1L, 1L, 2L, 2L, 4L, 1L, 1L, 1L, 1L, 1L, 1L, 1L,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           1L, 1L, 1L, 1L), levels = c("four", "six", "five", "three",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       "twelve", "two", "eight"), class = "factor"), `engine-size` = c(109,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       136, 136, 131, 108, 108, 164, 164, 61, 90, 90, 90, 90, 98,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       90, 90, 90, 122, 156, 92), `fuel-system` = structure(c(1L,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 2L, 1L, 2L, 2L,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              2L, 2L, 3L, 4L), levels = c("mpfi", "2bbl", "mfi", "1bbl",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "spfi", "4bbl", "idi", "spdi"), class = "factor"), bore = c(3.19,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      3.19, 3.19, 3.13, 3.5, 3.5, 3.31, 3.31, 2.91, 3.03, 3.03,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      2.97, 2.97, 3.03, 2.97, 2.97, 2.97, 3.34, 3.6, 2.91), stroke = c(3.4,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       3.4, 3.4, 3.4, 2.8, 2.8, 3.19, 3.19, 3.03, 3.11, 3.11, 3.23,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       3.23, 3.39, 3.23, 3.23, 3.23, 3.46, 3.9, 3.41), `compression-ratio` = c(10,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               8, 8.5, 8.3, 8.8, 8.8, 9, 9, 9.5, 9.6, 9.6, 9.41, 9.4, 7.6,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               9.4, 9.4, 9.4, 8.5, 7, 9.6), horsepower = c(102, 115, 110,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           140, 101, 101, 121, 121, 48, 70, 70, 68, 68, 102, 68, 68,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           68, 88, 145, 58), `peak-rpm` = c(5500, 5500, 5500, 5500,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            5800, 5800, 4250, 4250, 5100, 5400, 5400, 5500, 5500, 5500,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            5500, 5500, 5500, 5000, 5000, 4800), `city-mpg` = c(24, 18,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                19, 17, 23, 23, 21, 21, 47, 38, 38, 37, 31, 24, 31, 31, 31,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                24, 19, 49), `highway-mpg` = c(30, 22, 25, 20, 29, 29, 28,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               28, 53, 43, 43, 41, 38, 30, 38, 38, 38, 30, 24, 54), price = c(13950,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              17450, 17710, 23875, 16430, 16925, 20970, 21105, 5151, 6295,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              6575, 5572, 6377, 7957, 6229, 6692, 7609, 8921, 12964, 6479
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               )), row.names = c(NA, -20L), class = c("tbl_df", "tbl", "data.frame"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ), na.action = structure(c(`1` = 1L, `2` = 2L, `3` = 3L, `6` = 6L,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          `8` = 8L, `10` = 10L, `15` = 15L, `16` = 16L, `17` = 17L, `18` = 18L,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          `28` = 28L, `44` = 44L, `45` = 45L, `46` = 46L, `47` = 47L, `49` = 49L,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          `50` = 50L, `56` = 56L, `57` = 57L, `58` = 58L, `59` = 59L, `64` = 64L,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          `67` = 67L, `72` = 72L, `74` = 74L, `75` = 75L, `76` = 76L, `83` = 83L,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          `84` = 84L, `85` = 85L, `110` = 110L, `111` = 111L, `114` = 114L,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          `115` = 115L, `125` = 125L, `127` = 127L, `128` = 128L, `129` = 129L,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          `130` = 130L, `131` = 131L, `132` = 132L, `182` = 182L, `190` = 190L,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          `192` = 192L, `193` = 193L, `194` = 194L), class = "omit"))

  expect_equal(nrow(get_tr_tst(df, "at")[[1]]) %in% c(nrow(df) * 0.7, nrow(df) *
                                                        0.7 - 1),
               TRUE)
  expect_equal(nrow(get_tr_tst(df, "at")[[2]]), nrow(df) * 0.3)
  expect_equal(nrow(get_tr_tst(df, "sub")[[1]]) %in% c(nrow(df) * 0.7, nrow(df) *
                                                         0.7 - 1),
               TRUE)
  expect_equal(nrow(get_tr_tst(df, "sub")[[2]]), nrow(df) * 0.3)

  expect_equal(nrow(get_tr_tst(df, "basic")[[1]]) %in% c(nrow(df) * 0.7, nrow(df) *
                                                           0.7 - 1),
               TRUE)
  expect_equal(nrow(get_tr_tst(df, "basic")[[2]]), nrow(df) * 0.3)


  expect_warning(get_tr_tst(df, "other"), "invalid input")
})







# tests for get_trm_tsm()
test_that("get_trm_tsm() failed", {
  df <- structure(list(symboling = structure(c(3L, 3L, 2L, 2L, 3L, 4L,
                                               4L, 4L, 3L, 2L, 4L, 2L, 2L, 2L, 2L, 2L, 2L, 5L, 1L, 3L), levels = c("3",
                                                                                                                   "1", "2", "0", "-1", "-2"), class = "factor"), `normalized-losses` = c(164,
                                                                                                                                                                                          164, 158, 158, 192, 192, 188, 188, 121, 98, 81, 118, 118, 118,
                                                                                                                                                                                          148, 148, 148, 110, 145, 137), make = structure(c(2L, 2L, 2L,
                                                                                                                                                                                                                                            2L, 3L, 3L, 3L, 3L, 4L, 4L, 4L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L,
                                                                                                                                                                                                                                            6L), levels = c("alfa-romero", "audi", "bmw", "chevrolet", "dodge",
                                                                                                                                                                                                                                                            "honda", "isuzu", "jaguar", "mazda", "mercedes-benz", "mercury",
                                                                                                                                                                                                                                                            "mitsubishi", "nissan", "peugot", "plymouth", "porsche", "renault",
                                                                                                                                                                                                                                                            "saab", "subaru", "toyota", "volkswagen", "volvo"), class = "factor"),
                       `fuel-type` = structure(c(1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L,
                                                 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L), levels = c("gas",
                                                                                                             "diesel"), class = "factor"), aspiration = structure(c(1L,
                                                                                                                                                                    1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 1L,
                                                                                                                                                                    1L, 1L, 2L, 1L), levels = c("std", "turbo"), class = "factor"),
                       `num-of-doors` = structure(c(2L, 2L, 2L, 2L, 1L, 2L, 1L,
                                                    2L, 1L, 1L, 2L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 1L, 1L), levels = c("two",
                                                                                                                    "four"), class = "factor"), `body-style` = structure(c(3L,
                                                                                                                                                                           3L, 3L, 3L, 3L, 3L, 3L, 3L, 2L, 2L, 3L, 2L, 2L, 2L, 2L, 3L,
                                                                                                                                                                           3L, 4L, 2L, 2L), levels = c("convertible", "hatchback", "sedan",
                                                                                                                                                                                                       "wagon", "hardtop"), class = "factor"), `drive-wheels` = structure(c(2L,
                                                                                                                                                                                                                                                                            3L, 2L, 2L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L,
                                                                                                                                                                                                                                                                            2L, 2L, 2L, 2L), levels = c("rwd", "fwd", "4wd"), class = "factor"),
                       `engine-location` = structure(c(1L, 1L, 1L, 1L, 1L, 1L, 1L,
                                                       1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L), levels = c("front",
                                                                                                                       "rear"), class = "factor"), `wheel-base` = c(99.8, 99.4,
                                                                                                                                                                    105.8, 105.8, 101.2, 101.2, 101.2, 101.2, 88.4, 94.5, 94.5,
                                                                                                                                                                    93.7, 93.7, 93.7, 93.7, 93.7, 93.7, 103.3, 95.9, 86.6), length = c(176.6,
                                                                                                                                                                                                                                       176.6, 192.7, 192.7, 176.8, 176.8, 176.8, 176.8, 141.1, 155.9,
                                                                                                                                                                                                                                       158.8, 157.3, 157.3, 157.3, 157.3, 157.3, 157.3, 174.6, 173.2,
                                                                                                                                                                                                                                       144.6), width = c(66.2, 66.4, 71.4, 71.4, 64.8, 64.8, 64.8,
                                                                                                                                                                                                                                                         64.8, 60.3, 63.6, 63.6, 63.8, 63.8, 63.8, 63.8, 63.8, 63.8,
                                                                                                                                                                                                                                                         64.6, 66.3, 63.9), height = c(54.3, 54.3, 55.7, 55.9, 54.3,
                                                                                                                                                                                                                                                                                       54.3, 54.3, 54.3, 53.2, 52, 52, 50.8, 50.8, 50.8, 50.6, 50.6,
                                                                                                                                                                                                                                                                                       50.6, 59.8, 50.2, 50.8), `curb-weight` = c(2337, 2824, 2844,
                                                                                                                                                                                                                                                                                                                                  3086, 2395, 2395, 2710, 2765, 1488, 1874, 1909, 1876, 1876,
                                                                                                                                                                                                                                                                                                                                  2128, 1967, 1989, 1989, 2535, 2811, 1713), `engine-type` = structure(c(3L,
                                                                                                                                                                                                                                                                                                                                                                                                         3L, 3L, 3L, 3L, 3L, 3L, 3L, 4L, 3L, 3L, 3L, 3L, 3L, 3L, 3L,
                                                                                                                                                                                                                                                                                                                                                                                                         3L, 3L, 3L, 3L), levels = c("dohc", "ohcv", "ohc", "l", "rotor",
                                                                                                                                                                                                                                                                                                                                                                                                                                     "ohcf", "dohcv"), class = "factor"), `num-of-cylinders` = structure(c(1L,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           3L, 3L, 3L, 1L, 1L, 2L, 2L, 4L, 1L, 1L, 1L, 1L, 1L, 1L, 1L,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           1L, 1L, 1L, 1L), levels = c("four", "six", "five", "three",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       "twelve", "two", "eight"), class = "factor"), `engine-size` = c(109,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       136, 136, 131, 108, 108, 164, 164, 61, 90, 90, 90, 90, 98,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       90, 90, 90, 122, 156, 92), `fuel-system` = structure(c(1L,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 2L, 1L, 2L, 2L,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              2L, 2L, 3L, 4L), levels = c("mpfi", "2bbl", "mfi", "1bbl",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "spfi", "4bbl", "idi", "spdi"), class = "factor"), bore = c(3.19,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      3.19, 3.19, 3.13, 3.5, 3.5, 3.31, 3.31, 2.91, 3.03, 3.03,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      2.97, 2.97, 3.03, 2.97, 2.97, 2.97, 3.34, 3.6, 2.91), stroke = c(3.4,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       3.4, 3.4, 3.4, 2.8, 2.8, 3.19, 3.19, 3.03, 3.11, 3.11, 3.23,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       3.23, 3.39, 3.23, 3.23, 3.23, 3.46, 3.9, 3.41), `compression-ratio` = c(10,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               8, 8.5, 8.3, 8.8, 8.8, 9, 9, 9.5, 9.6, 9.6, 9.41, 9.4, 7.6,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               9.4, 9.4, 9.4, 8.5, 7, 9.6), horsepower = c(102, 115, 110,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           140, 101, 101, 121, 121, 48, 70, 70, 68, 68, 102, 68, 68,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           68, 88, 145, 58), `peak-rpm` = c(5500, 5500, 5500, 5500,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            5800, 5800, 4250, 4250, 5100, 5400, 5400, 5500, 5500, 5500,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            5500, 5500, 5500, 5000, 5000, 4800), `city-mpg` = c(24, 18,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                19, 17, 23, 23, 21, 21, 47, 38, 38, 37, 31, 24, 31, 31, 31,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                24, 19, 49), `highway-mpg` = c(30, 22, 25, 20, 29, 29, 28,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               28, 53, 43, 43, 41, 38, 30, 38, 38, 38, 30, 24, 54), price = c(13950,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              17450, 17710, 23875, 16430, 16925, 20970, 21105, 5151, 6295,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              6575, 5572, 6377, 7957, 6229, 6692, 7609, 8921, 12964, 6479
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               )), row.names = c(NA, -20L), class = c("tbl_df", "tbl", "data.frame"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ), na.action = structure(c(`1` = 1L, `2` = 2L, `3` = 3L, `6` = 6L,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          `8` = 8L, `10` = 10L, `15` = 15L, `16` = 16L, `17` = 17L, `18` = 18L,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          `28` = 28L, `44` = 44L, `45` = 45L, `46` = 46L, `47` = 47L, `49` = 49L,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          `50` = 50L, `56` = 56L, `57` = 57L, `58` = 58L, `59` = 59L, `64` = 64L,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          `67` = 67L, `72` = 72L, `74` = 74L, `75` = 75L, `76` = 76L, `83` = 83L,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          `84` = 84L, `85` = 85L, `110` = 110L, `111` = 111L, `114` = 114L,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          `115` = 115L, `125` = 125L, `127` = 127L, `128` = 128L, `129` = 129L,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          `130` = 130L, `131` = 131L, `132` = 132L, `182` = 182L, `190` = 190L,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          `192` = 192L, `193` = 193L, `194` = 194L), class = "omit"))
  #y matrix is only one vector get_trm_tsm(), where ncol=NULL
  training_df_sub <- get_tr_tst(df, "sub")[[1]]
  testing_df_sub <- get_tr_tst(df, "sub")[[2]]
  training_df <- get_tr_tst(df, "basic")[[1]]
  testing_df <- get_tr_tst(df, "basic")[[2]]
  training_df_at <- get_tr_tst(df, "at")[[1]]
  testing_df_at <- get_tr_tst(df, "at")[[2]]

  expect_equal(ncol(
    get_trm_tsm(training_df_sub, testing_df_sub, set = "training")[[1]]
  ),
  18)

  expect_equal(ncol(
    get_trm_tsm(training_df_sub, testing_df_sub, set = "training")[[2]]
  ),
  NULL)

  expect_equal(ncol(
    get_trm_tsm(training_df_sub, testing_df_sub, set = "testing")[[1]]
  ),
  18)

  expect_equal(ncol(
    get_trm_tsm(training_df_sub, testing_df_sub, set = "testing")[[2]]
  ),
  NULL)
})



# tests for get_model_plot()
test_that("get_model_plot() failed", {
  # remove warning for traning model for small datasets
  options(warn=-1)
  # set up
  df <- structure(list(symboling = structure(c(3L, 3L, 2L, 2L, 3L, 4L,
                                               4L, 4L, 3L, 2L, 4L, 2L, 2L, 2L, 2L, 2L, 2L, 5L, 1L, 3L), levels = c("3",
                                                                                                                   "1", "2", "0", "-1", "-2"), class = "factor"), `normalized-losses` = c(164,
                                                                                                                                                                                          164, 158, 158, 192, 192, 188, 188, 121, 98, 81, 118, 118, 118,
                                                                                                                                                                                          148, 148, 148, 110, 145, 137), make = structure(c(2L, 2L, 2L,
                                                                                                                                                                                                                                            2L, 3L, 3L, 3L, 3L, 4L, 4L, 4L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L,
                                                                                                                                                                                                                                            6L), levels = c("alfa-romero", "audi", "bmw", "chevrolet", "dodge",
                                                                                                                                                                                                                                                            "honda", "isuzu", "jaguar", "mazda", "mercedes-benz", "mercury",
                                                                                                                                                                                                                                                            "mitsubishi", "nissan", "peugot", "plymouth", "porsche", "renault",
                                                                                                                                                                                                                                                            "saab", "subaru", "toyota", "volkswagen", "volvo"), class = "factor"),
                       `fuel-type` = structure(c(1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L,
                                                 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L), levels = c("gas",
                                                                                                             "diesel"), class = "factor"), aspiration = structure(c(1L,
                                                                                                                                                                    1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 1L,
                                                                                                                                                                    1L, 1L, 2L, 1L), levels = c("std", "turbo"), class = "factor"),
                       `num-of-doors` = structure(c(2L, 2L, 2L, 2L, 1L, 2L, 1L,
                                                    2L, 1L, 1L, 2L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 1L, 1L), levels = c("two",
                                                                                                                    "four"), class = "factor"), `body-style` = structure(c(3L,
                                                                                                                                                                           3L, 3L, 3L, 3L, 3L, 3L, 3L, 2L, 2L, 3L, 2L, 2L, 2L, 2L, 3L,
                                                                                                                                                                           3L, 4L, 2L, 2L), levels = c("convertible", "hatchback", "sedan",
                                                                                                                                                                                                       "wagon", "hardtop"), class = "factor"), `drive-wheels` = structure(c(2L,
                                                                                                                                                                                                                                                                            3L, 2L, 2L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L,
                                                                                                                                                                                                                                                                            2L, 2L, 2L, 2L), levels = c("rwd", "fwd", "4wd"), class = "factor"),
                       `engine-location` = structure(c(1L, 1L, 1L, 1L, 1L, 1L, 1L,
                                                       1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L), levels = c("front",
                                                                                                                       "rear"), class = "factor"), `wheel-base` = c(99.8, 99.4,
                                                                                                                                                                    105.8, 105.8, 101.2, 101.2, 101.2, 101.2, 88.4, 94.5, 94.5,
                                                                                                                                                                    93.7, 93.7, 93.7, 93.7, 93.7, 93.7, 103.3, 95.9, 86.6), length = c(176.6,
                                                                                                                                                                                                                                       176.6, 192.7, 192.7, 176.8, 176.8, 176.8, 176.8, 141.1, 155.9,
                                                                                                                                                                                                                                       158.8, 157.3, 157.3, 157.3, 157.3, 157.3, 157.3, 174.6, 173.2,
                                                                                                                                                                                                                                       144.6), width = c(66.2, 66.4, 71.4, 71.4, 64.8, 64.8, 64.8,
                                                                                                                                                                                                                                                         64.8, 60.3, 63.6, 63.6, 63.8, 63.8, 63.8, 63.8, 63.8, 63.8,
                                                                                                                                                                                                                                                         64.6, 66.3, 63.9), height = c(54.3, 54.3, 55.7, 55.9, 54.3,
                                                                                                                                                                                                                                                                                       54.3, 54.3, 54.3, 53.2, 52, 52, 50.8, 50.8, 50.8, 50.6, 50.6,
                                                                                                                                                                                                                                                                                       50.6, 59.8, 50.2, 50.8), `curb-weight` = c(2337, 2824, 2844,
                                                                                                                                                                                                                                                                                                                                  3086, 2395, 2395, 2710, 2765, 1488, 1874, 1909, 1876, 1876,
                                                                                                                                                                                                                                                                                                                                  2128, 1967, 1989, 1989, 2535, 2811, 1713), `engine-type` = structure(c(3L,
                                                                                                                                                                                                                                                                                                                                                                                                         3L, 3L, 3L, 3L, 3L, 3L, 3L, 4L, 3L, 3L, 3L, 3L, 3L, 3L, 3L,
                                                                                                                                                                                                                                                                                                                                                                                                         3L, 3L, 3L, 3L), levels = c("dohc", "ohcv", "ohc", "l", "rotor",
                                                                                                                                                                                                                                                                                                                                                                                                                                     "ohcf", "dohcv"), class = "factor"), `num-of-cylinders` = structure(c(1L,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           3L, 3L, 3L, 1L, 1L, 2L, 2L, 4L, 1L, 1L, 1L, 1L, 1L, 1L, 1L,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           1L, 1L, 1L, 1L), levels = c("four", "six", "five", "three",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       "twelve", "two", "eight"), class = "factor"), `engine-size` = c(109,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       136, 136, 131, 108, 108, 164, 164, 61, 90, 90, 90, 90, 98,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       90, 90, 90, 122, 156, 92), `fuel-system` = structure(c(1L,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 2L, 1L, 2L, 2L,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              2L, 2L, 3L, 4L), levels = c("mpfi", "2bbl", "mfi", "1bbl",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "spfi", "4bbl", "idi", "spdi"), class = "factor"), bore = c(3.19,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      3.19, 3.19, 3.13, 3.5, 3.5, 3.31, 3.31, 2.91, 3.03, 3.03,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      2.97, 2.97, 3.03, 2.97, 2.97, 2.97, 3.34, 3.6, 2.91), stroke = c(3.4,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       3.4, 3.4, 3.4, 2.8, 2.8, 3.19, 3.19, 3.03, 3.11, 3.11, 3.23,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       3.23, 3.39, 3.23, 3.23, 3.23, 3.46, 3.9, 3.41), `compression-ratio` = c(10,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               8, 8.5, 8.3, 8.8, 8.8, 9, 9, 9.5, 9.6, 9.6, 9.41, 9.4, 7.6,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               9.4, 9.4, 9.4, 8.5, 7, 9.6), horsepower = c(102, 115, 110,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           140, 101, 101, 121, 121, 48, 70, 70, 68, 68, 102, 68, 68,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           68, 88, 145, 58), `peak-rpm` = c(5500, 5500, 5500, 5500,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            5800, 5800, 4250, 4250, 5100, 5400, 5400, 5500, 5500, 5500,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            5500, 5500, 5500, 5000, 5000, 4800), `city-mpg` = c(24, 18,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                19, 17, 23, 23, 21, 21, 47, 38, 38, 37, 31, 24, 31, 31, 31,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                24, 19, 49), `highway-mpg` = c(30, 22, 25, 20, 29, 29, 28,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               28, 53, 43, 43, 41, 38, 30, 38, 38, 38, 30, 24, 54), price = c(13950,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              17450, 17710, 23875, 16430, 16925, 20970, 21105, 5151, 6295,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              6575, 5572, 6377, 7957, 6229, 6692, 7609, 8921, 12964, 6479
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               )), row.names = c(NA, -20L), class = c("tbl_df", "tbl", "data.frame"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ), na.action = structure(c(`1` = 1L, `2` = 2L, `3` = 3L, `6` = 6L,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          `8` = 8L, `10` = 10L, `15` = 15L, `16` = 16L, `17` = 17L, `18` = 18L,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          `28` = 28L, `44` = 44L, `45` = 45L, `46` = 46L, `47` = 47L, `49` = 49L,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          `50` = 50L, `56` = 56L, `57` = 57L, `58` = 58L, `59` = 59L, `64` = 64L,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          `67` = 67L, `72` = 72L, `74` = 74L, `75` = 75L, `76` = 76L, `83` = 83L,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          `84` = 84L, `85` = 85L, `110` = 110L, `111` = 111L, `114` = 114L,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          `115` = 115L, `125` = 125L, `127` = 127L, `128` = 128L, `129` = 129L,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          `130` = 130L, `131` = 131L, `132` = 132L, `182` = 182L, `190` = 190L,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          `192` = 192L, `193` = 193L, `194` = 194L), class = "omit"))
  training_df_sub <- get_tr_tst(df, "sub")[[1]]
  testing_df_sub <- get_tr_tst(df, "sub")[[2]]
  training_df <- get_tr_tst(df, "basic")[[1]]
  testing_df <- get_tr_tst(df, "basic")[[2]]
  training_df_at <- get_tr_tst(df, "at")[[1]]
  testing_df_at <- get_tr_tst(df, "at")[[2]]
  x_train_mat <-
    get_trm_tsm(training_df_sub, testing_df_sub, set = "training")[[1]]
  y_train_mat <-
    get_trm_tsm(training_df_sub, testing_df_sub, set = "training")[[2]]
  x_test_mat <-
    get_trm_tsm(training_df_sub, testing_df_sub, set = "testing")[[1]]
  y_test_mat <-
    get_trm_tsm(training_df_sub, testing_df_sub, set = "testing")[[2]]

  # tests:
  expect_true("glmnet" %in%
                class(
                  get_model_plot(x_train_mat, y_train_mat,
                                 model = "lasso", ask = "modeling")[[1]]
                ))

  expect_true("glmnet" %in%
                class(
                  get_model_plot(x_train_mat, y_train_mat,
                                 model = "lasso", ask = "modeling")[[2]]
                ))

  expect_true("cv.glmnet" %in%
                class(
                  get_model_plot(x_train_mat, y_train_mat,
                                 model = "lasso", ask = "modeling")[[3]]
                ))

  expect_true("glmnet" %in%
                class(
                  get_model_plot(x_train_mat, y_train_mat,
                                 model = "ridge", ask = "modeling")[[1]]
                ))

  expect_true("glmnet" %in%
                class(
                  get_model_plot(x_train_mat, y_train_mat,
                                 model = "ridge", ask = "modeling")[[2]]
                ))

  expect_true("cv.glmnet" %in%
                class(
                  get_model_plot(x_train_mat, y_train_mat,
                                 model = "ridge", ask = "modeling")[[3]]
                ))

  expect_warning(
    get_model_plot(x_train_mat, y_train_mat,
                   model = "random forest", ask = "modeling"),
    "model should be lasso or ridge"
  )

  expect_warning(
    get_model_plot(x_train_mat, y_train_mat,
                   model = "ridge", ask = "modeling and plots"),
    "ask should be modeling or plot"
  )

})

# tests for get_er_cv

test_that("get_er_cv() failed",{
  options(warn=-1)
  # set up
  df <- structure(list(symboling = structure(c(3L, 3L, 2L, 2L, 3L, 4L,
                                               4L, 4L, 3L, 2L, 4L, 2L, 2L, 2L, 2L, 2L, 2L, 5L, 1L, 3L), levels = c("3",
                                                                                                                   "1", "2", "0", "-1", "-2"), class = "factor"), `normalized-losses` = c(164,
                                                                                                                                                                                          164, 158, 158, 192, 192, 188, 188, 121, 98, 81, 118, 118, 118,
                                                                                                                                                                                          148, 148, 148, 110, 145, 137), make = structure(c(2L, 2L, 2L,
                                                                                                                                                                                                                                            2L, 3L, 3L, 3L, 3L, 4L, 4L, 4L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L,
                                                                                                                                                                                                                                            6L), levels = c("alfa-romero", "audi", "bmw", "chevrolet", "dodge",
                                                                                                                                                                                                                                                            "honda", "isuzu", "jaguar", "mazda", "mercedes-benz", "mercury",
                                                                                                                                                                                                                                                            "mitsubishi", "nissan", "peugot", "plymouth", "porsche", "renault",
                                                                                                                                                                                                                                                            "saab", "subaru", "toyota", "volkswagen", "volvo"), class = "factor"),
                       `fuel-type` = structure(c(1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L,
                                                 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L), levels = c("gas",
                                                                                                             "diesel"), class = "factor"), aspiration = structure(c(1L,
                                                                                                                                                                    1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 1L,
                                                                                                                                                                    1L, 1L, 2L, 1L), levels = c("std", "turbo"), class = "factor"),
                       `num-of-doors` = structure(c(2L, 2L, 2L, 2L, 1L, 2L, 1L,
                                                    2L, 1L, 1L, 2L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 1L, 1L), levels = c("two",
                                                                                                                    "four"), class = "factor"), `body-style` = structure(c(3L,
                                                                                                                                                                           3L, 3L, 3L, 3L, 3L, 3L, 3L, 2L, 2L, 3L, 2L, 2L, 2L, 2L, 3L,
                                                                                                                                                                           3L, 4L, 2L, 2L), levels = c("convertible", "hatchback", "sedan",
                                                                                                                                                                                                       "wagon", "hardtop"), class = "factor"), `drive-wheels` = structure(c(2L,
                                                                                                                                                                                                                                                                            3L, 2L, 2L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L,
                                                                                                                                                                                                                                                                            2L, 2L, 2L, 2L), levels = c("rwd", "fwd", "4wd"), class = "factor"),
                       `engine-location` = structure(c(1L, 1L, 1L, 1L, 1L, 1L, 1L,
                                                       1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L), levels = c("front",
                                                                                                                       "rear"), class = "factor"), `wheel-base` = c(99.8, 99.4,
                                                                                                                                                                    105.8, 105.8, 101.2, 101.2, 101.2, 101.2, 88.4, 94.5, 94.5,
                                                                                                                                                                    93.7, 93.7, 93.7, 93.7, 93.7, 93.7, 103.3, 95.9, 86.6), length = c(176.6,
                                                                                                                                                                                                                                       176.6, 192.7, 192.7, 176.8, 176.8, 176.8, 176.8, 141.1, 155.9,
                                                                                                                                                                                                                                       158.8, 157.3, 157.3, 157.3, 157.3, 157.3, 157.3, 174.6, 173.2,
                                                                                                                                                                                                                                       144.6), width = c(66.2, 66.4, 71.4, 71.4, 64.8, 64.8, 64.8,
                                                                                                                                                                                                                                                         64.8, 60.3, 63.6, 63.6, 63.8, 63.8, 63.8, 63.8, 63.8, 63.8,
                                                                                                                                                                                                                                                         64.6, 66.3, 63.9), height = c(54.3, 54.3, 55.7, 55.9, 54.3,
                                                                                                                                                                                                                                                                                       54.3, 54.3, 54.3, 53.2, 52, 52, 50.8, 50.8, 50.8, 50.6, 50.6,
                                                                                                                                                                                                                                                                                       50.6, 59.8, 50.2, 50.8), `curb-weight` = c(2337, 2824, 2844,
                                                                                                                                                                                                                                                                                                                                  3086, 2395, 2395, 2710, 2765, 1488, 1874, 1909, 1876, 1876,
                                                                                                                                                                                                                                                                                                                                  2128, 1967, 1989, 1989, 2535, 2811, 1713), `engine-type` = structure(c(3L,
                                                                                                                                                                                                                                                                                                                                                                                                         3L, 3L, 3L, 3L, 3L, 3L, 3L, 4L, 3L, 3L, 3L, 3L, 3L, 3L, 3L,
                                                                                                                                                                                                                                                                                                                                                                                                         3L, 3L, 3L, 3L), levels = c("dohc", "ohcv", "ohc", "l", "rotor",
                                                                                                                                                                                                                                                                                                                                                                                                                                     "ohcf", "dohcv"), class = "factor"), `num-of-cylinders` = structure(c(1L,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           3L, 3L, 3L, 1L, 1L, 2L, 2L, 4L, 1L, 1L, 1L, 1L, 1L, 1L, 1L,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           1L, 1L, 1L, 1L), levels = c("four", "six", "five", "three",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       "twelve", "two", "eight"), class = "factor"), `engine-size` = c(109,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       136, 136, 131, 108, 108, 164, 164, 61, 90, 90, 90, 90, 98,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       90, 90, 90, 122, 156, 92), `fuel-system` = structure(c(1L,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 2L, 1L, 2L, 2L,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              2L, 2L, 3L, 4L), levels = c("mpfi", "2bbl", "mfi", "1bbl",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "spfi", "4bbl", "idi", "spdi"), class = "factor"), bore = c(3.19,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      3.19, 3.19, 3.13, 3.5, 3.5, 3.31, 3.31, 2.91, 3.03, 3.03,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      2.97, 2.97, 3.03, 2.97, 2.97, 2.97, 3.34, 3.6, 2.91), stroke = c(3.4,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       3.4, 3.4, 3.4, 2.8, 2.8, 3.19, 3.19, 3.03, 3.11, 3.11, 3.23,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       3.23, 3.39, 3.23, 3.23, 3.23, 3.46, 3.9, 3.41), `compression-ratio` = c(10,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               8, 8.5, 8.3, 8.8, 8.8, 9, 9, 9.5, 9.6, 9.6, 9.41, 9.4, 7.6,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               9.4, 9.4, 9.4, 8.5, 7, 9.6), horsepower = c(102, 115, 110,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           140, 101, 101, 121, 121, 48, 70, 70, 68, 68, 102, 68, 68,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           68, 88, 145, 58), `peak-rpm` = c(5500, 5500, 5500, 5500,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            5800, 5800, 4250, 4250, 5100, 5400, 5400, 5500, 5500, 5500,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            5500, 5500, 5500, 5000, 5000, 4800), `city-mpg` = c(24, 18,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                19, 17, 23, 23, 21, 21, 47, 38, 38, 37, 31, 24, 31, 31, 31,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                24, 19, 49), `highway-mpg` = c(30, 22, 25, 20, 29, 29, 28,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               28, 53, 43, 43, 41, 38, 30, 38, 38, 38, 30, 24, 54), price = c(13950,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              17450, 17710, 23875, 16430, 16925, 20970, 21105, 5151, 6295,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              6575, 5572, 6377, 7957, 6229, 6692, 7609, 8921, 12964, 6479
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               )), row.names = c(NA, -20L), class = c("tbl_df", "tbl", "data.frame"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ), na.action = structure(c(`1` = 1L, `2` = 2L, `3` = 3L, `6` = 6L,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          `8` = 8L, `10` = 10L, `15` = 15L, `16` = 16L, `17` = 17L, `18` = 18L,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          `28` = 28L, `44` = 44L, `45` = 45L, `46` = 46L, `47` = 47L, `49` = 49L,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          `50` = 50L, `56` = 56L, `57` = 57L, `58` = 58L, `59` = 59L, `64` = 64L,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          `67` = 67L, `72` = 72L, `74` = 74L, `75` = 75L, `76` = 76L, `83` = 83L,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          `84` = 84L, `85` = 85L, `110` = 110L, `111` = 111L, `114` = 114L,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          `115` = 115L, `125` = 125L, `127` = 127L, `128` = 128L, `129` = 129L,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          `130` = 130L, `131` = 131L, `132` = 132L, `182` = 182L, `190` = 190L,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          `192` = 192L, `193` = 193L, `194` = 194L), class = "omit"))
  training_df_sub <- get_tr_tst(df, "sub")[[1]]
  testing_df_sub <- get_tr_tst(df, "sub")[[2]]
  training_df <- get_tr_tst(df, "basic")[[1]]
  testing_df <- get_tr_tst(df, "basic")[[2]]
  training_df_at <- get_tr_tst(df, "at")[[1]]
  testing_df_at <- get_tr_tst(df, "at")[[2]]
  x_train_mat <-
    get_trm_tsm(training_df_sub, testing_df_sub, set = "training")[[1]]
  y_train_mat <-
    get_trm_tsm(training_df_sub, testing_df_sub, set = "training")[[2]]
  x_test_mat <-
    get_trm_tsm(training_df_sub, testing_df_sub, set = "testing")[[1]]
  y_test_mat <-
    get_trm_tsm(training_df_sub, testing_df_sub, set = "testing")[[2]]
  lasso_cv <-
    get_model_plot(x_train_mat, y_train_mat, model = "lasso", ask = "modeling")[[3]]
  ridge_cv <-
    get_model_plot(x_train_mat, y_train_mat, model = "ridge", ask = "modeling")[[3]]
  output <- get_er_cv(training_df_at, training_df_sub, kfolds = 10, lasso_cv,ridge_cv)
  expect_equal(nrow(output), 5)
  expect_equal(ncol(output), 2)
  expect_equal(colnames(output), c("Model", "R_MSE"))

})

